# Architecture Overview

## ğŸ—ï¸ Complete System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         SHRI RAM PHYSIO SYSTEM                              â”‚
â”‚                    (Offline-First with Cloud Sync)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                    FRONTEND (Electron + React)
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                               â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
    â”‚  â”‚   React UI      â”‚         â”‚  Electron Main  â”‚            â”‚
    â”‚  â”‚  - Patient Form â”‚         â”‚  - IPC Handler  â”‚            â”‚
    â”‚  â”‚  - Invoice Form â”‚â—„â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  - SQLite DB    â”‚            â”‚
    â”‚  â”‚  - Reports      â”‚         â”‚  - Sync Manager â”‚            â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
    â”‚                                       â”‚                      â”‚
    â”‚                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
    â”‚                              â”‚  Prisma Client  â”‚             â”‚
    â”‚                              â”‚  (SQLite)       â”‚             â”‚
    â”‚                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
    â”‚                                       â”‚                      â”‚
    â”‚                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
    â”‚                              â”‚   dev.db        â”‚             â”‚
    â”‚                              â”‚  (Local SQLite) â”‚             â”‚
    â”‚                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
    â”‚                                                               â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â”‚ HTTP POST /api/sync
                                   â”‚ AZURE_BACKEND_URL
                                   â”‚ (http://localhost:3000)
                                   â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚         NETWORK             â”‚
                    â”‚   (CORS-protected API)      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                  BACKEND (Docker Compose)                    â”‚
    â”‚                  Stack: shree-ram-physio                     â”‚
    â”‚                                                              â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚  â”‚           Container: backend (Node 22)               â”‚  â”‚
    â”‚  â”‚  Port: 3000                                           â”‚  â”‚
    â”‚  â”‚                                                       â”‚  â”‚
    â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚  â”‚
    â”‚  â”‚  â”‚  Express API   â”‚        â”‚  Sync          â”‚       â”‚  â”‚
    â”‚  â”‚  â”‚  - /health     â”‚        â”‚  Controller    â”‚       â”‚  â”‚
    â”‚  â”‚  â”‚  - /api/       â”‚â—„â”€â”€â”€â”€â”€â”€â–ºâ”‚  - Upsert      â”‚       â”‚  â”‚
    â”‚  â”‚  â”‚    patients    â”‚        â”‚  - ID Mapping  â”‚       â”‚  â”‚
    â”‚  â”‚  â”‚  - /api/       â”‚        â”‚  - Conflict    â”‚       â”‚  â”‚
    â”‚  â”‚  â”‚    invoices    â”‚        â”‚    Resolution  â”‚       â”‚  â”‚
    â”‚  â”‚  â”‚  - /api/sync   â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚  â”‚
    â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚               â”‚  â”‚
    â”‚  â”‚                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”       â”‚  â”‚
    â”‚  â”‚                            â”‚  Prisma Client â”‚       â”‚  â”‚
    â”‚  â”‚                            â”‚  (v7.1.0)      â”‚       â”‚  â”‚
    â”‚  â”‚                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚  â”‚
    â”‚  â”‚                                     â”‚               â”‚  â”‚
    â”‚  â”‚                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”       â”‚  â”‚
    â”‚  â”‚                            â”‚ @prisma/       â”‚       â”‚  â”‚
    â”‚  â”‚                            â”‚ adapter-mssql  â”‚       â”‚  â”‚
    â”‚  â”‚                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚  â”‚
    â”‚  â”‚                                     â”‚               â”‚  â”‚
    â”‚  â”‚                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”       â”‚  â”‚
    â”‚  â”‚                            â”‚  mssql driver  â”‚       â”‚  â”‚
    â”‚  â”‚                            â”‚  (tedious)     â”‚       â”‚  â”‚
    â”‚  â”‚                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚  â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
    â”‚                                        â”‚                  â”‚
    â”‚                               Internal Docker Network     â”‚
    â”‚                                        â”‚                  â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
    â”‚  â”‚      Container: sqlserver (SQL Server 2022)         â”‚ â”‚
    â”‚  â”‚      Port: 1433                                     â”‚ â”‚
    â”‚  â”‚                                                     â”‚ â”‚
    â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
    â”‚  â”‚  â”‚         Database: shri_ram_physio_dev        â”‚  â”‚ â”‚
    â”‚  â”‚  â”‚                                              â”‚  â”‚ â”‚
    â”‚  â”‚  â”‚  Tables:                                     â”‚  â”‚ â”‚
    â”‚  â”‚  â”‚  - patients                                  â”‚  â”‚ â”‚
    â”‚  â”‚  â”‚  - invoices                                  â”‚  â”‚ â”‚
    â”‚  â”‚  â”‚  - treatments                                â”‚  â”‚ â”‚
    â”‚  â”‚  â”‚                                              â”‚  â”‚ â”‚
    â”‚  â”‚  â”‚  Persistent Volume: sqlserver_data           â”‚  â”‚ â”‚
    â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
    â”‚                                                          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                        PRODUCTION (Azure)
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                          â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚  â”‚         Azure App Service                          â”‚  â”‚
    â”‚  â”‚         (Backend Deployment)                       â”‚  â”‚
    â”‚  â”‚                                                    â”‚  â”‚
    â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
    â”‚  â”‚  â”‚  Same Backend Code                           â”‚  â”‚  â”‚
    â”‚  â”‚  â”‚  DATABASE_URL â†’ Azure SQL                    â”‚  â”‚  â”‚
    â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”˜  â”‚
    â”‚                         â”‚                                â”‚
    â”‚                         â”‚ TLS Connection                 â”‚
    â”‚                         â”‚                                â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
    â”‚  â”‚         Azure SQL Database                        â”‚   â”‚
    â”‚  â”‚  Server: shree-ram-physio-server.database...      â”‚   â”‚
    â”‚  â”‚  Database: shree-ram-physio-db                    â”‚   â”‚
    â”‚  â”‚  User: adminUser                                  â”‚   â”‚
    â”‚  â”‚  Encryption: Required                             â”‚   â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
    â”‚                                                          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ Data Sync Flow

```
STEP 1: Local Data Entry (Offline)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User enters patient data in Frontend â”‚
â”‚ â†’ Saved to local SQLite immediately  â”‚
â”‚ â†’ localId assigned (e.g., 1, 2, 3)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
STEP 2: Sync Trigger (When Online)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Frontend detects internet connection â”‚
â”‚ â†’ Reads all local records            â”‚
â”‚ â†’ Prepares sync payload               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
STEP 3: Send to Backend
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ POST /api/sync                       â”‚
â”‚ Body: {                              â”‚
â”‚   patients: [                        â”‚
â”‚     {id: 1, cloudId: null, ...},     â”‚
â”‚     {id: 2, cloudId: 123, ...}       â”‚
â”‚   ],                                 â”‚
â”‚   invoices: [...],                   â”‚
â”‚   treatments: [...]                  â”‚
â”‚ }                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
STEP 4: Backend Processing
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ For each record:                     â”‚
â”‚ - If cloudId exists â†’ UPDATE         â”‚
â”‚ - If cloudId is null â†’ CREATE        â”‚
â”‚ - Track localId â†’ cloudId mapping    â”‚
â”‚                                      â”‚
â”‚ Example:                             â”‚
â”‚ patient {id:1, cloudId:null}         â”‚
â”‚ â†’ prisma.patient.create(...)         â”‚
â”‚ â†’ Returns cloudId: 456               â”‚
â”‚                                      â”‚
â”‚ patient {id:2, cloudId:123}          â”‚
â”‚ â†’ prisma.patient.update({id:123})    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
STEP 5: Return Mapping + Updates
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Response: {                          â”‚
â”‚   synced: {                          â”‚
â”‚     patients: [                      â”‚
â”‚       {localId: 1, cloudId: 456},    â”‚
â”‚       {localId: 2, cloudId: 123}     â”‚
â”‚     ]                                â”‚
â”‚   },                                 â”‚
â”‚   updates: {                         â”‚
â”‚     patients: [/* newer records */], â”‚
â”‚     invoices: [...]                  â”‚
â”‚   }                                  â”‚
â”‚ }                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
STEP 6: Update Local Database
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Frontend updates local records:      â”‚
â”‚ - Set cloudId for new records        â”‚
â”‚ - Update changed records from cloud  â”‚
â”‚ - Mark as synced                     â”‚
â”‚                                      â”‚
â”‚ UPDATE patients                      â”‚
â”‚ SET cloudId = 456                    â”‚
â”‚ WHERE id = 1                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ” Security & Connection Details

### Backend â†’ SQL Server Connection

```typescript
// Parsed from DATABASE_URL
{
  server: "localhost" (or "sqlserver" in Docker network),
  port: 1433,
  database: "shri_ram_physio_dev",
  user: "sa",
  password: "YourStrong@Passw0rd",
  options: {
    encrypt: true,              // TLS encryption
    trustServerCertificate: true // For local dev
  }
}
```

### CORS Protection

```typescript
// Backend only accepts requests from:
ALLOWED_ORIGINS = [
  "http://localhost:5173",  // Vite dev server
  "http://localhost:3000"   // Backend itself
]
```

### Rate Limiting

```typescript
// Max 100 requests per 15 minutes per IP
{
  windowMs: 15 * 60 * 1000,
  max: 100
}
```

## ğŸ“Š Technology Stack Summary

| Layer | Technology | Version | Purpose |
|-------|-----------|---------|---------|
| **Frontend UI** | React + TypeScript | Latest | User interface |
| **Frontend Runtime** | Electron | Latest | Desktop app wrapper |
| **Frontend DB** | SQLite + Prisma | Latest | Offline-first local storage |
| **Backend Runtime** | Node.js | 22-alpine | Server execution |
| **Backend Framework** | Express + TypeScript | Latest | REST API |
| **Backend ORM** | Prisma | 7.1.0 | Database abstraction |
| **Backend DB Driver** | @prisma/adapter-mssql | 7.1.0 | SQL Server adapter |
| **DB Driver** | mssql (tedious) | 12.2.0 | Native SQL Server protocol |
| **Local Database** | SQL Server 2022 | 2022-latest | Development database |
| **Production DB** | Azure SQL Database | Cloud | Production database |
| **Container** | Docker + Docker Compose | Latest | Containerization |

## ğŸ¯ Key Features

1. **Offline-First**: Frontend works without internet
2. **Auto-Sync**: Syncs when connection available
3. **Conflict Resolution**: Last-write-wins strategy
4. **ID Mapping**: Local IDs â†’ Cloud IDs tracked
5. **Multi-Device**: Multiple frontends sync to same backend
6. **Health Monitoring**: Both containers have health checks
7. **Persistent Storage**: Docker volumes for data persistence
8. **Security**: CORS, rate limiting, helmet.js protection
9. **Type Safety**: Full TypeScript coverage
10. **Production Ready**: Easy switch to Azure SQL

## ğŸš€ Deployment Modes

### Development (Current)
- Frontend: Electron app on developer machine
- Backend: Docker Compose (SQL Server 2022 local)
- Connection: `http://localhost:3000`

### Production (Future)
- Frontend: Electron app on user machines
- Backend: Azure App Service
- Database: Azure SQL Database
- Connection: `https://shri-ram-physio-api.azurewebsites.net`

### Migration Path
1. Change `.env.production` in Frontend:
   ```
   AZURE_BACKEND_URL=https://your-app.azurewebsites.net
   ```
2. Deploy backend to Azure App Service
3. Update `DATABASE_URL` to Azure SQL connection string
4. No code changes required!
